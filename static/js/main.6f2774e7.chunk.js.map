{"version":3,"sources":["music/note.js","music/interval.js","music/mode.js","music/scale.js","music/key.js","player/arpeggiator.js","components/AccidentalInput/AccidentalInput.jsx","components/NoteInput/NoteInput.jsx","components/ScaleQuestion/ScaleQuestion.jsx","music/random.js","components/Menu/Menu.jsx","components/Menu/MenuBar.jsx","components/ScaleTrainer/ScaleTrainer.jsx","components/Breakpoint/Breakpoint.jsx","components/App/App.jsx","serviceWorker.js","index.js"],"names":["PITCHES","SHARP_ACCIDENTAL","NATURAL_ACCIDENTAL","FLAT_ACCIDENTAL","ACCIDENTALS","ACCIDENTAL_SIMPLE_NOTATION_MAP","_ACCIDENTAL_SIMPLE_NO","Object","defineProperty","Note","pitch","accidental","classCallCheck","this","createClass","key","value","note","onlySharpNote1","normalizeAccidentals","onlySharpNote2","hasEqualPitch","hasEqualAccidental","createNote","nextAccidentalIndex","indexOf","length","nextAccidental","previousAccidental","arguments","undefined","nextPitch","previousPitch","noteToString","get","accidentalToString","notes1","notes2","map","note1","noteIndex","note2","equals","some","comparison","previousPitchIndex","nextPitchIndex","MAJOR_MINOR_PERFECT_INTERVALS","AUGMENTED_DIMINISHED_INTERVALS","INTERVAL_SEMITONE_MAP","P1","d2","m2","A1","semitone","half tone","half step","H","M2","d3","tone","whole tone","whole step","W","m3","A2","M3","d4","P4","A3","d5","A4","tritone","P5","d6","m6","A5","M6","d7","m7","A6","M7","d8","P8","A7","NEXT_SEMITONE_MAP","A","_A","B","_B","C","_C","D","_D","E","_E","F","_F","G","_G","relativeIntervalsToRootIntervals","root","relativeIntervals","intervalNames","semitonesToRoot","reduce","intervals","relativeInterval","toConsumableArray","concat","CHURCH_MODES","NO_MODES","Scale","name","construction","modes","MAJOR_CONSTRUCTION","MINOR_CONSTRUCTION","MELODIC_MINOR_CONSTRUCTION","CHROMATIC_CONSTRUCTION","AUGMENTED_CONSTRUCTION","MAJOR_BLUES_CONSTRUCTION","MINOR_BLUES_CONSTRUCTION","MAJOR_PENTATONIC_CONSTRUCTION","MINOR_PENTATONIC_CONSTRUCTION","HARMONIC_MINOR_SCALE","MELODIC_MINOR_SCALE","MAJOR_SCALE","MINOR_SCALE","CHROMATIC_SCALE","AUGMENTED_SCALE","MAJOR_BLUES_SCALE","MINOR_BLUES_SCALE","MAJOR_PENTATONIC_SCALE","MINOR_PENTATONIC_SCALE","SCALES","getScaleByName","scaleName","find","scale","Key","mode","_this","modeConstruction","slice","notes","interval","currentNote","n","numberOfSemitones","augmentedNote","augmentedSemitones","addInterval","description","rootNote","modeName","alternativeModeName","trim","String","modeIndex","objectSpread","array","rotateByOffset","element","index","_rotateArray","synthesizer","Tone","AMSynth","toMaster","Arpeggiator","triggerSelector","isAppleIOS","startAudioContext","context","onPlayNote","onStop","_removeAllPatterns","pitchOctaves","simpleNotation","pitchOrder","octaveIndex","noteName","_appendOctave","numberOfArpeggioNotes","playedNotes","pattern","Pattern","time","triggerAttackRelease","setTimeout","_patterns","push","iterations","start","Transport","stop","forEach","cancel","clear","dispose","noop","AccidentalInput","_ref","isCurrentAccidental","accidentalIndex","isDisabled","onChange","className","classNames","note__accidental","note__accidental--selected","note__accidental--disabled","react_default","a","createElement","onClick","_createHandleAccidentalChange","KEY_CODE_ARROW_LEFT","KEY_CODE_ARROW_UP","KEY_CODE_ARROW_RIGHT","KEY_CODE_ARROW_DOWN","NoteInput","props","isSelected","onSwitchNote","note--error","showError","note--highlighted","isHighlighted","type","disabled","tabIndex","autoFocus","onFocus","e","el","selectionStart","selectionEnd","createTextRange","focus","range","collapse","select","_placeCaretAtEnd","target","preventDefault","pitchCandidate","toUpperCase","substr","_toPitch","_createHandlePitchChange","onKeyDown","isArrowDown","keyCode","isArrowUp","isArrowLeft","isArrowRight","nextNote","getLoweredNote","getRaisedNote","offset","_createHandlePitchKeyDown","maxLength","includes","DEFAULT_NOTE","ScaleQuestionComponent","state","correctNotes","isAnswered","isCorrect","showErrors","showHint","selectedNoteIndex","_handleAnswer","_canBeAnswered","setState","actualNotes","question","toNotes","keys","answeredNotes","areNoteArraysEqual","_handleHintClick","hintIndex","_getRandomInt","min","max","exclude","randomInt","Math","floor","random","_handlePlayClick","play","_handlePlayNote","_handleStop","highlightedNoteIndex","_handleNextClick","onNextClick","_handleNoteChange","_updateNote","_handleSwitchNote","nextNoteIndex","maxNoteIndex","registerTrigger","_isRoot","_this2","numberOfNotes","Array","from","_getNote","isRoot","isEnabled","NoteInput_NoteInput","showNotes","react_fretboard_default","skinType","selectedNotes","showSelectionLabels","scaleConstruction","hints","join","renderFretboard","modifier","answerDisabled","hintDisabled","renderScaleInputs","renderActions","renderHint","renderSolution","_this3","noteIndices","requiredNumberOfAnswers","areAllNotesComplete","Component","IGNORED_NOTES","getRandomKey","includeAccidentals","includeModes","scaleOptions","getRandomArrayElement","scaleNames","_scaleOptionsToScaleNames","getRandomScale","getRandomMode","getRandomNote","ignoredNote","isIgnoredNote","Menu","_handleOptionChange","event","onOptionChange","checked","_handleScaleOptionChange","onScaleOptionChange","onlyMajorScaleSelected","_onlyMajorScaleSelected","htmlFor","id","options","scales","isOpen","onClose","renderOptions","numberOfScales","MenuBar","onOpen","DEFAULT_SCALES","INITIAL_STATE","isMenuOpen","_getBooleanFromLocalStorage","defaultValue","localStorage","getItem","JSON","parse","_getObjectFromLocalStorage","ScaleTrainer","_updateQuestion","option","setItem","_updateOption","s","_selectRequiredScales","stringify","_updateScaleOption","_handleMenuButtonClick","ScaleQuestion_ScaleQuestionComponent","_questionToString","Menu_Menu_Menu","MenuBar_MenuBar","renderQuestion","Breakpoint","Fragment","App","ScaleTrainer_ScaleTrainer_ScaleTrainer","Breakpoint_Breakpoint","Boolean","window","location","hostname","match","ReactDOM","render","components_App_App","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.6f2774e7.chunk.js","sourcesContent":["// @flow\nexport type Pitch = 'A' | 'B' | 'C' | 'D' | 'E' | 'F' | 'G';\nexport type Accidental = '♯' | '♭' | '♮';\n\nexport const PITCHES: Pitch[] = ['A', 'B', 'C', 'D', 'E', 'F', 'G'];\nexport const SHARP_ACCIDENTAL: Accidental = '♯';\nexport const NATURAL_ACCIDENTAL: Accidental = '♮';\nexport const FLAT_ACCIDENTAL: Accidental = '♭';\nexport const ACCIDENTALS: Accidental[] = [SHARP_ACCIDENTAL, NATURAL_ACCIDENTAL, FLAT_ACCIDENTAL];\n\nconst ACCIDENTAL_SIMPLE_NOTATION_MAP = {\n    [NATURAL_ACCIDENTAL]: '',\n    [SHARP_ACCIDENTAL]: '#',\n    [FLAT_ACCIDENTAL]: 'b'\n};\n\nexport class Note {\n    pitch: ?Pitch;\n    accidental: Accidental;\n\n    constructor(pitch: ?Pitch, accidental: Accidental) {\n        this.pitch = pitch;\n        this.accidental = accidental;\n    }\n\n    static accidentalToString(accidental: Accidental): string {\n        return accidental === NATURAL_ACCIDENTAL ? '' : accidental;\n    }\n\n    static noteToString(note: Note): string {\n        return note.pitch + Note.accidentalToString(note.accidental);\n    }\n\n    static areNoteArraysEqual(notes1: Note[], notes2: Note[]): boolean {\n        if (notes1.length !== notes2.length) {\n            return false;\n        }\n        return !notes1.map((note1: Note, noteIndex: number) => {\n            const note2 = notes2[noteIndex];\n            return note1.equals(note2);\n        }).some(comparison => !comparison);\n    }\n\n    get simpleNotation(): string {\n        return this.pitch + (this.accidental ? ACCIDENTAL_SIMPLE_NOTATION_MAP[this.accidental] : '');\n    }\n\n    equals(note: Note): boolean {\n        const onlySharpNote1 = this.normalizeAccidentals();\n        const onlySharpNote2 = note.normalizeAccidentals();\n        return onlySharpNote1.hasEqualPitch(onlySharpNote2)\n            && onlySharpNote1.hasEqualAccidental(onlySharpNote2);\n    }\n\n    hasEqualPitch(note: Note) {\n        return this.pitch === note.pitch;\n    }\n\n    hasEqualAccidental(note: Note) {\n        return this.accidental === note.accidental;\n    }\n\n    getRaisedNote(): Note {\n        return createNote(this.pitch, nextAccidental(this.accidental));\n    }\n\n    getLoweredNote() {\n        return createNote(this.pitch, previousAccidental(this.accidental));\n    }\n\n    normalizeAccidentals(preferredAccidental: Accidental = SHARP_ACCIDENTAL): Note {\n        if (preferredAccidental === FLAT_ACCIDENTAL) {\n            if (this.accidental === SHARP_ACCIDENTAL) {\n                return createNote(\n                    nextPitch(this.pitch),\n                    this.pitch === 'B' || this.pitch === 'E' ? NATURAL_ACCIDENTAL : FLAT_ACCIDENTAL\n                );\n            } else if (this.accidental === FLAT_ACCIDENTAL) {\n                if (this.pitch === 'C' || this.pitch === 'F') {\n                    return createNote(\n                        previousPitch(this.pitch),\n                        NATURAL_ACCIDENTAL\n                    );\n                }\n            }\n        } else {\n            if (this.accidental === FLAT_ACCIDENTAL) {\n                return createNote(\n                    previousPitch(this.pitch),\n                    this.pitch === 'C' || this.pitch === 'F' ? NATURAL_ACCIDENTAL : SHARP_ACCIDENTAL\n                );\n            } else if (this.accidental === SHARP_ACCIDENTAL) {\n                if (this.pitch === 'B' || this.pitch === 'E') {\n                    return createNote(\n                        nextPitch(this.pitch),\n                        NATURAL_ACCIDENTAL\n                    );\n                }\n            }\n        }\n        return this;\n    }\n\n    toString() {\n        return Note.noteToString(this);\n    }\n\n    clone(): Note {\n        return createNote(this.pitch, this.accidental);\n    }\n}\n\nexport function createNote(pitch: ?Pitch, accidental: ?Accidental): Note {\n    return new Note(pitch, accidental ? accidental : NATURAL_ACCIDENTAL);\n}\n\nexport function previousPitch(pitch: Pitch): Pitch {\n    const previousPitchIndex = (PITCHES.indexOf(pitch) + PITCHES.length - 1) % PITCHES.length;\n    return PITCHES[previousPitchIndex];\n}\n\nexport function nextPitch(pitch: Pitch): Pitch {\n    const nextPitchIndex = (PITCHES.indexOf(pitch) + 1) % PITCHES.length;\n    return PITCHES[nextPitchIndex];\n}\n\nexport function previousAccidental(accidental: Accidental): Accidental {\n    const nextAccidentalIndex = (ACCIDENTALS.indexOf(accidental) + 1) % ACCIDENTALS.length;\n    return ACCIDENTALS[nextAccidentalIndex];\n}\n\nexport function nextAccidental(accidental: Accidental): Accidental {\n    const nextAccidentalIndex = (ACCIDENTALS.indexOf(accidental) + ACCIDENTALS.length - 1) % ACCIDENTALS.length;\n    return ACCIDENTALS[nextAccidentalIndex];\n}","import {\n    createNote,\n    FLAT_ACCIDENTAL,\n    NATURAL_ACCIDENTAL,\n    Note,\n    SHARP_ACCIDENTAL\n} from './note';\nimport {Key} from './key';\n\nexport type MajorMinorPerfectInterval =\n    'P1' // perfect unison\n    | 'm2' // minor second\n    | 'M2' // major second\n    | 'm3' // minor third\n    | 'M3' // major third\n    | 'P4' // perfect fourth\n    | 'P5' // perfect fifth\n    | 'm6' // minor sixth\n    | 'M6' // major sixth\n    | 'm7' // minor seventh\n    | 'M7' // major seventh\n    | 'P8'; // perfect octave\n\nexport type AugmentedDiminishedInterval =\n    'd2' // diminished second\n    | 'A1' // augmented unison\n    | 'd3' // diminished third\n    | 'A2' // augmented second\n    | 'd4' // diminished fourth\n    | 'A3' // augmented third\n    | 'd5' // diminished fifth (=A4)\n    | 'A4' // augmented forth (=d5)\n    | 'd6' // diminished sixth\n    | 'A5' // augmented fifth\n    | 'd7' // diminished seventh\n    | 'A6' // augmented sixth\n    | 'd8' // diminished octave\n    | 'A7';\n\nexport type AlternativeInterval =\n    'semitone'\n    | 'half tone'\n    | 'half step'\n    | 'tone'\n    | 'whole tone'\n    | 'whole step'\n    | 'tritone';\n\nexport type StepInterval = 'H' | 'W';\n\nexport type Interval = MajorMinorPerfectInterval | AugmentedDiminishedInterval | AlternativeInterval | StepInterval;\n\nexport const MAJOR_MINOR_PERFECT_INTERVALS: MajorMinorPerfectInterval[] = [\n    'P1',\n    'm2',\n    'M2',\n    'm3',\n    'M3',\n    'P4',\n    'P5',\n    'm6',\n    'M6',\n    'm7',\n    'M7',\n    'P8'\n];\n\nexport const AUGMENTED_DIMINISHED_INTERVALS: AugmentedDiminishedInterval[] = [\n    'd2',\n    'A1',\n    'd3',\n    'A2',\n    'd4',\n    'A3',\n    'd5',\n    'A4',\n    'd6',\n    'A5',\n    'd7',\n    'A6',\n    'd8',\n    'A7'\n];\n\nexport const SEMITONE: AlternativeInterval = 'semitone';\nexport const WHOLE_TONE: AlternativeInterval = 'whole tone';\n\nexport const WHOLE_STEP: StepInterval = 'W';\nexport const HALF_STEP: StepInterval = 'H';\n\nexport const AUGMENTED_SECOND: AugmentedDiminishedInterval = 'A2';\n\nexport const INTERVAL_SEMITONE_MAP: {[Interval]: number} = {\n    'P1': 0,\n    'd2': 0,\n\n    'm2': 1,\n    'A1': 1,\n    'semitone': 1,\n    'half tone': 1,\n    'half step': 1,\n    'H': 1,\n\n    'M2': 2,\n    'd3': 2,\n    'tone': 2,\n    'whole tone': 2,\n    'whole step': 2,\n    'W': 2,\n\n    'm3': 3,\n    'A2': 3,\n\n    'M3': 4,\n    'd4': 4,\n\n    'P4': 5,\n    'A3': 5,\n\n    'd5': 6,\n    'A4': 6,\n    'tritone': 6,\n\n    'P5': 7,\n    'd6': 7,\n\n    'm6': 8,\n    'A5': 8,\n\n    'M6': 9,\n    'd7': 9,\n\n    'm7': 10,\n    'A6': 10,\n\n    'M7': 11,\n    'd8': 11,\n\n    'P8': 12,\n    'A7': 12\n};\n\nconst NEXT_SEMITONE_MAP = {\n    'A': {\n        [FLAT_ACCIDENTAL]: createNote('A'),\n        [NATURAL_ACCIDENTAL]: createNote('A', SHARP_ACCIDENTAL),\n        [SHARP_ACCIDENTAL]: createNote('B')\n    },\n    'B': {\n        [FLAT_ACCIDENTAL]: createNote('B'),\n        [NATURAL_ACCIDENTAL]: createNote('C'),\n        [SHARP_ACCIDENTAL]: createNote('C', SHARP_ACCIDENTAL)\n    },\n    'C': {\n        [FLAT_ACCIDENTAL]: createNote('C'),\n        [NATURAL_ACCIDENTAL]: createNote('C', SHARP_ACCIDENTAL),\n        [SHARP_ACCIDENTAL]: createNote('D')\n    },\n    'D': {\n        [FLAT_ACCIDENTAL]: createNote('D'),\n        [NATURAL_ACCIDENTAL]: createNote('D', SHARP_ACCIDENTAL),\n        [SHARP_ACCIDENTAL]: createNote('E')\n    },\n    'E': {\n        [FLAT_ACCIDENTAL]: createNote('E'),\n        [NATURAL_ACCIDENTAL]: createNote('F'),\n        [SHARP_ACCIDENTAL]: createNote('F', SHARP_ACCIDENTAL)\n    },\n    'F': {\n        [FLAT_ACCIDENTAL]: createNote('F'),\n        [NATURAL_ACCIDENTAL]: createNote('F', SHARP_ACCIDENTAL),\n        [SHARP_ACCIDENTAL]: createNote('G')\n    },\n    'G': {\n        [FLAT_ACCIDENTAL]: createNote('G'),\n        [NATURAL_ACCIDENTAL]: createNote('G', SHARP_ACCIDENTAL),\n        [SHARP_ACCIDENTAL]: createNote('A')\n    }\n};\n\nexport function addInterval(n: Note, interval: Interval | number): Note {\n    const numberOfSemitones = typeof interval === 'number'\n        ? interval\n        : INTERVAL_SEMITONE_MAP[interval];\n\n    let augmentedNote = n;\n    for (let augmentedSemitones = 0; augmentedSemitones < numberOfSemitones; augmentedSemitones++) {\n        augmentedNote = NEXT_SEMITONE_MAP[augmentedNote.pitch][augmentedNote.accidental];\n    }\n\n    return augmentedNote;\n}\n\nexport function relativeIntervalsToRootIntervals(root: Key,\n    relativeIntervals: Interval[],\n    intervalNames: Interval[] = MAJOR_MINOR_PERFECT_INTERVALS): Interval[] {\n    let semitonesToRoot = -1;\n    return relativeIntervals.reduce((intervals: Interval[], relativeInterval: Interval) => {\n        semitonesToRoot += INTERVAL_SEMITONE_MAP[relativeInterval];\n        return [...intervals, intervalNames[semitonesToRoot]];\n    }, []);\n}","// @flow\n\nexport type HarmonicMinorMode =\n    'harmonic minor'\n    | 'locrian ♯6'\n    | 'ionian ♯5'\n    | 'dorian ♯4'\n    | 'phrygian dominant'\n    | 'lydian ♯2'\n    | 'superlocrian';\nexport type MelodicMinorMode =\n    'melodic minor'\n    | 'dorian ♭2'\n    | 'lydian ♯5'\n    | 'lydian ♭7'\n    | 'mixolydian ♭6'\n    | 'locrian ♯2'\n    | 'superlocrian';\nexport type ChurchMode = 'ionian' | 'dorian' | 'phrygian' | 'lydian' | 'mixolydian' | 'aeolian' | 'locrian';\nexport type Mode = ChurchMode | HarmonicMinorMode | MelodicMinorMode;\n\nexport const CHURCH_MODES: ChurchMode[] = [\n    'ionian',\n    'dorian',\n    'phrygian',\n    'lydian',\n    'mixolydian',\n    'aeolian',\n    'locrian'\n];\n\nexport const HARMONIC_MINOR_MODES: HarmonicMinorMode[] = [\n    'harmonic minor',\n    'locrian ♯6',\n    'ionian ♯5',\n    'dorian ♯4',\n    'phrygian dominant',\n    'lydian ♯2',\n    'ultralocrian'\n];\n\nexport const MELODIC_MINOR_MODES: MelodicMinorMode[] = [\n    'melodic minor',\n    'dorian ♭2',\n    'lydian ♯5',\n    'lydian ♭7',\n    'mixolydian ♭6',\n    'locrian ♯2',\n    'superlocrian'\n];","// @flow\nimport type {Interval} from './interval';\nimport {\n    AUGMENTED_SECOND,\n    HALF_STEP,\n    WHOLE_STEP\n} from './interval';\nimport type {Mode} from './mode';\nimport {\n    CHURCH_MODES,\n    HARMONIC_MINOR_MODES,\n    MELODIC_MINOR_MODES\n} from './mode';\n\nexport type ScaleConstruction = Interval[];\nexport type ScaleName = 'major' | 'minor' | 'harmonic minor';\n\nconst NO_MODES: Mode[] = [];\n\nexport class Scale {\n    name: ScaleName;\n    construction: ScaleConstruction;\n    modes: Mode[];\n\n    constructor(name: ScaleName, construction: ScaleConstruction, modes: Mode[] = NO_MODES) {\n        this.name = name;\n        this.construction = construction;\n        this.modes = modes;\n    }\n\n    toString() {\n        return this.name;\n    }\n}\n\nexport const MAJOR_CONSTRUCTION: ScaleConstruction = [\n    WHOLE_STEP,\n    WHOLE_STEP,\n    HALF_STEP,\n    WHOLE_STEP,\n    WHOLE_STEP,\n    WHOLE_STEP,\n    HALF_STEP\n];\n\nexport const MINOR_CONSTRUCTION: ScaleConstruction = [\n    WHOLE_STEP,\n    HALF_STEP,\n    WHOLE_STEP,\n    WHOLE_STEP,\n    HALF_STEP,\n    WHOLE_STEP,\n    WHOLE_STEP\n];\n\nexport const HARMONIC_MINOR_CONSTRUCTION: ScaleConstruction = [\n    WHOLE_STEP,\n    HALF_STEP,\n    WHOLE_STEP,\n    WHOLE_STEP,\n    HALF_STEP,\n    AUGMENTED_SECOND,\n    HALF_STEP\n];\n\nexport const MELODIC_MINOR_CONSTRUCTION: ScaleConstruction = [\n    WHOLE_STEP,\n    HALF_STEP,\n    WHOLE_STEP,\n    WHOLE_STEP,\n    WHOLE_STEP,\n    WHOLE_STEP,\n    HALF_STEP\n];\n\nexport const CHROMATIC_CONSTRUCTION: ScaleConstruction = [\n    HALF_STEP,\n    HALF_STEP,\n    HALF_STEP,\n    HALF_STEP,\n    HALF_STEP,\n    HALF_STEP,\n    HALF_STEP,\n    HALF_STEP,\n    HALF_STEP,\n    HALF_STEP,\n    HALF_STEP,\n    HALF_STEP\n];\n\nexport const AUGMENTED_CONSTRUCTION: ScaleConstruction = [\n    AUGMENTED_SECOND,\n    HALF_STEP,\n    AUGMENTED_SECOND,\n    HALF_STEP,\n    AUGMENTED_SECOND,\n    HALF_STEP\n];\n\nexport const MAJOR_BLUES_CONSTRUCTION: ScaleConstruction = [\n    WHOLE_STEP,\n    HALF_STEP,\n    HALF_STEP,\n    AUGMENTED_SECOND,\n    WHOLE_STEP,\n    AUGMENTED_SECOND\n];\n\nexport const MINOR_BLUES_CONSTRUCTION: ScaleConstruction = [\n    AUGMENTED_SECOND,\n    WHOLE_STEP,\n    HALF_STEP,\n    HALF_STEP,\n    AUGMENTED_SECOND,\n    HALF_STEP\n];\n\nexport const MAJOR_PENTATONIC_CONSTRUCTION: ScaleConstruction = [\n    WHOLE_STEP,\n    WHOLE_STEP,\n    AUGMENTED_SECOND,\n    WHOLE_STEP,\n    AUGMENTED_SECOND\n];\n\nexport const MINOR_PENTATONIC_CONSTRUCTION: ScaleConstruction = [\n    AUGMENTED_SECOND,\n    WHOLE_STEP,\n    WHOLE_STEP,\n    AUGMENTED_SECOND,\n    WHOLE_STEP\n];\n\nexport const HARMONIC_MINOR_SCALE = new Scale('harmonic minor', HARMONIC_MINOR_CONSTRUCTION, HARMONIC_MINOR_MODES);\nexport const MELODIC_MINOR_SCALE = new Scale('melodic minor', MELODIC_MINOR_CONSTRUCTION, MELODIC_MINOR_MODES);\nexport const MAJOR_SCALE = new Scale('major', MAJOR_CONSTRUCTION, CHURCH_MODES);\nexport const MINOR_SCALE = new Scale('minor', MINOR_CONSTRUCTION, CHURCH_MODES);\nexport const CHROMATIC_SCALE = new Scale('chromatic', CHROMATIC_CONSTRUCTION);\nexport const AUGMENTED_SCALE = new Scale('augmented', AUGMENTED_CONSTRUCTION);\nexport const MAJOR_BLUES_SCALE = new Scale('major blues', MAJOR_BLUES_CONSTRUCTION);\nexport const MINOR_BLUES_SCALE = new Scale('minor blues', MINOR_BLUES_CONSTRUCTION);\nexport const MAJOR_PENTATONIC_SCALE = new Scale('major pentatonic', MAJOR_PENTATONIC_CONSTRUCTION);\nexport const MINOR_PENTATONIC_SCALE = new Scale('minor pentatonic', MINOR_PENTATONIC_CONSTRUCTION);\n\nexport const SCALES: Scale[] = [\n    MAJOR_SCALE,\n    MINOR_SCALE,\n    HARMONIC_MINOR_SCALE,\n    MELODIC_MINOR_SCALE,\n    CHROMATIC_SCALE,\n    AUGMENTED_SCALE,\n    MAJOR_BLUES_SCALE,\n    MINOR_BLUES_SCALE,\n    MAJOR_PENTATONIC_SCALE,\n    MINOR_PENTATONIC_SCALE\n];\n\nexport function getScaleByName(scaleName: ScaleName) {\n    return SCALES.find(scale => scale.name === scaleName);\n}","import {Note} from './note';\nimport type {Interval} from './interval';\nimport {addInterval} from './interval';\nimport type {ScaleConstruction} from './scale';\nimport {Scale} from './scale';\nimport type {Mode} from './mode';\n\nexport type KeyDescription = {\n    rootNote: string,\n    scaleName: string,\n    modeName?: string,\n    alternativeModeName?: string\n}\n\nexport class Key {\n    root: Note;\n    scale: Scale;\n    mode: ?Mode;\n\n    constructor(root: Note, scale: Scale, mode: Mode) {\n        this.root = root;\n        this.scale = scale;\n        this.mode = mode;\n    }\n\n    get description(): KeyDescription {\n        const description: KeyDescription = {\n            rootNote: String(this.root),\n            scaleName: String(this.scale)\n        };\n        if (this.scale.modes.length === 0) {\n            return description;\n        }\n        const modeIndex = this.scale.modes.indexOf(this.mode);\n        return modeIndex === 0\n            ? description\n            : {\n                ...description,\n                modeName: String(this.mode),\n                alternativeModeName: `mode ${modeIndex + 1} of ${this.scale.name}`\n            };\n    }\n\n    toNotes(): Note[] {\n        return [..._removeRoot(this.modeConstruction).reduce((notes: Note[], interval: Interval) => {\n            const previousNote = notes[notes.length - 1];\n            const currentNote = addInterval(previousNote, interval);\n            return [...notes, currentNote.normalizeAccidentals(this.root.accidental)];\n        }, [this.root]), this.root];\n    }\n\n    get modeConstruction(): ScaleConstruction {\n        return this.mode\n            ? _rotateArray(this.scale.construction, this.scale.modes.indexOf(this.mode))\n            : this.scale.construction;\n    }\n\n    toString(): string {\n        const description = this.description;\n        return `${description.rootNote} ${description.scaleName} ${description.modeName ||\n        ''} ${description.alternativeModeName ? `(${description.alternativeModeName})` : ''}`.trim();\n    }\n}\n\nfunction _rotateArray<T>(array: T[], rotateByOffset: number) {\n    const length = array.length;\n    return array.map((element: T, index: number) => array[(((rotateByOffset + index) % length) + length) % length]);\n}\n\nfunction _removeRoot(construction: ScaleConstruction): ScaleConstruction {\n    return construction.slice(0, -1);\n}","// @flow\nimport {Note} from '../music/note';\nimport startAudioContext from 'startaudiocontext';\nimport Tone from 'tone';\nimport isAppleIOS from 'is-ios';\n\nconst synthesizer = new Tone.AMSynth().toMaster();\n\nexport type NoteCallback = (noteIndex: number) => void;\nexport type StopCallback = () => void;\n\nexport default class Arpeggiator {\n    static _patterns: Tone.Pattern[] = [];\n\n    static registerTrigger(triggerSelector: string) {\n        if (isAppleIOS) {\n            startAudioContext(Tone.context, triggerSelector);\n        }\n    }\n\n    static play(notes: Note[], onPlayNote: ?NoteCallback, onStop: ?StopCallback) {\n        Arpeggiator._removeAllPatterns();\n\n        const pitchOctaves = notes\n            .map((note: Note) => note.simpleNotation)\n            .map(_appendOctave(notes));\n        const numberOfArpeggioNotes = pitchOctaves.length * 2 - 1;\n        let playedNotes = 0;\n\n        const pattern = new Tone.Pattern(function (time, note) {\n            const noteIndex = pitchOctaves.indexOf(note);\n            if (onPlayNote) {\n                onPlayNote(noteIndex);\n            }\n            synthesizer.triggerAttackRelease(note, 0.5);\n            playedNotes++;\n            if (onStop && playedNotes === numberOfArpeggioNotes) {\n                setTimeout(() => {\n                    onStop();\n                    Arpeggiator._removeAllPatterns();\n                }, 500);\n            }\n        }, pitchOctaves, 'upDown');\n\n        Arpeggiator._patterns.push(pattern);\n\n        pattern.iterations = numberOfArpeggioNotes;\n        pattern.start(0);\n\n        Tone.Transport.start();\n    }\n\n    static stop(onStop: ?StopCallback) {\n        if (onStop) {\n            onStop();\n            Tone.Transport.stop();\n            Arpeggiator._removeAllPatterns();\n        }\n    }\n\n    static _removeAllPatterns() {\n        Arpeggiator._patterns.forEach((pattern: Tone.Pattern) => {\n            Tone.Transport.stop();\n            Tone.Transport.cancel(pattern);\n            Tone.Transport.clear(pattern);\n            pattern.dispose();\n        });\n        Arpeggiator._patterns = [];\n    }\n}\n\nfunction _appendOctave(notes: Note[]) {\n    const pitchOrder = ['C', 'D', 'E', 'F', 'G', 'A', 'B'];\n    let octaveIndex = 3;\n    return (noteName: string, noteIndex: number) => {\n        if (noteIndex === 0) {\n            return `${noteName}${octaveIndex}`;\n        }\n\n        if (pitchOrder.indexOf(notes[noteIndex - 1].pitch) > pitchOrder.indexOf(notes[noteIndex].pitch)) {\n            octaveIndex++;\n        }\n\n        return `${noteName}${octaveIndex}`;\n    };\n}","// @flow\nimport React from 'react';\nimport type {Accidental} from '../../music/note';\nimport classNames from 'classnames';\n\ntype AccidentalChangeHandler = (noteIndex: number, accidental: Accidental) => void;\n\ntype Props = {\n    accidental: Accidental,\n    accidentalIndex: number,\n    isCurrentAccidental: boolean,\n    isDisabled: boolean,\n    noteIndex: number,\n    onChange: AccidentalChangeHandler\n};\n\nconst noop = () => {};\n\nexport default function AccidentalInput({accidental, accidentalIndex, isCurrentAccidental, isDisabled, noteIndex, onChange}: Props) {\n    const className = classNames({\n        'note__accidental': true,\n        'note__accidental--selected': isCurrentAccidental,\n        'note__accidental--disabled': isDisabled\n    });\n    return (\n        <div\n            className={className}\n            onClick={isDisabled ? noop : _createHandleAccidentalChange(noteIndex, accidental, onChange)}>\n            {accidental}\n        </div>\n    );\n}\n\nfunction _createHandleAccidentalChange(noteIndex: number, accidental: Accidental, onChange: AccidentalChangeHandler) {\n    return () => {\n        onChange(noteIndex, accidental);\n    };\n}","// @flow\nimport React from 'react';\nimport type {\n    Accidental,\n    Note,\n    Pitch\n} from '../../music/note';\nimport {\n    ACCIDENTALS,\n    createNote,\n    FLAT_ACCIDENTAL,\n    PITCHES,\n    SHARP_ACCIDENTAL\n} from '../../music/note';\nimport AccidentalInput from '../AccidentalInput/AccidentalInput';\nimport classNames from 'classnames';\nimport './NoteInput.scss';\n\ntype NoteInputChangeHandler = (noteIndex: number, note: Note) => void;\ntype SwitchNoteHandler = (nextNoteIndex: number) => void;\n\ntype Props = {\n    isDisabled: boolean,\n    isHighlighted: boolean,\n    isSelected: boolean,\n    note: Note,\n    noteIndex: number,\n    onChange: NoteInputChangeHandler,\n    onSwitchNote: SwitchNoteHandler,\n    showError: boolean\n};\n\nconst KEY_CODE_ARROW_LEFT = 37;\nconst KEY_CODE_ARROW_UP = 38;\nconst KEY_CODE_ARROW_RIGHT = 39;\nconst KEY_CODE_ARROW_DOWN = 40;\n\nexport default function NoteInput(props: Props) {\n    const {isDisabled, isSelected, noteIndex, onChange, onSwitchNote, note} = props;\n    const className = classNames({\n        'note': true,\n        'note--error': props.showError,\n        'note--highlighted': props.isHighlighted\n    });\n    return (\n        <div className={className} key={`note-${noteIndex}${isSelected ? '-selected' : ''}`}>\n            <div className=\"note__pitch\">\n                <input\n                    type=\"text\"\n                    name={`note-${noteIndex}-pitch`}\n                    value={note.pitch || ''}\n                    disabled={isDisabled}\n                    tabIndex={noteIndex}\n                    autoFocus={isSelected}\n                    onFocus={(e) => _placeCaretAtEnd(e.target)}\n                    onChange={_createHandlePitchChange(noteIndex, note.accidental, onChange)}\n                    onKeyDown={_createHandlePitchKeyDown(noteIndex, note, onChange, onSwitchNote)}\n                    maxLength={2}\n                />\n            </div>\n            <div className=\"note__accidentals\">\n                {[...ACCIDENTALS].map((accidental, accidentalIndex) =>\n                    <AccidentalInput\n                        key={`accidental${accidentalIndex}`}\n                        accidental={accidental}\n                        accidentalIndex={accidentalIndex}\n                        isCurrentAccidental={accidental === note.accidental}\n                        isDisabled={isDisabled}\n                        noteIndex={noteIndex}\n                        onChange={_createHandleAccidentalChange(noteIndex, note.pitch, accidental, onChange)}/>\n                )}\n            </div>\n        </div>\n    );\n}\n\nfunction _createHandlePitchChange(noteIndex: number, accidental: Accidental, onChange: NoteInputChangeHandler) {\n    return (e: any) => {\n        e.preventDefault();\n        const pitchCandidate = e.target.value\n            .toUpperCase()\n            .substr(-1); // maxLength is 2 which allows multiple pitches to be entered but we use only the last.\n        const note = createNote(\n            _toPitch(pitchCandidate),\n            accidental\n        );\n        onChange(noteIndex, note);\n    };\n}\n\nfunction _createHandlePitchKeyDown(noteIndex: number,\n    note: Note,\n    onChange: NoteInputChangeHandler,\n    onSwitchNote: SwitchNoteHandler) {\n    return (e: any) => {\n        const isArrowDown = e.keyCode === KEY_CODE_ARROW_DOWN;\n        const isArrowUp = e.keyCode === KEY_CODE_ARROW_UP;\n        const isArrowLeft = e.keyCode === KEY_CODE_ARROW_LEFT;\n        const isArrowRight = e.keyCode === KEY_CODE_ARROW_RIGHT;\n        if (isArrowDown || isArrowUp) {\n            e.preventDefault();\n            const nextNote = note\n                ? isArrowDown ? note.getLoweredNote() : note.getRaisedNote()\n                : isArrowDown ? createNote(note.pitch, FLAT_ACCIDENTAL) : createNote(note.pitch, SHARP_ACCIDENTAL);\n            onChange(noteIndex, nextNote);\n        } else if (isArrowLeft || isArrowRight) {\n            const offset = isArrowRight ? 1 : -1;\n            onSwitchNote(noteIndex + offset);\n        } else {\n            e.target.value = _toPitch(e.key.toUpperCase());\n        }\n    };\n}\n\nfunction _createHandleAccidentalChange(noteIndex: number,\n    pitch: Pitch,\n    accidental: Accidental,\n    onChange: NoteInputChangeHandler) {\n    return () => {\n        const note = createNote(\n            pitch,\n            accidental\n        );\n        onChange(noteIndex, note);\n    };\n}\n\nfunction _toPitch(value: string): Pitch | '' {\n    const pitchCandidate: any = value.toUpperCase();\n    return PITCHES.includes(pitchCandidate)\n        ? pitchCandidate\n        : '';\n}\n\nfunction _placeCaretAtEnd(el: any) {\n    if (typeof el.selectionStart == 'number') {\n        el.selectionStart = el.selectionEnd = el.value.length + 1;\n    } else if (typeof el.createTextRange !== 'undefined') {\n        el.focus();\n        var range = el.createTextRange();\n        range.collapse(false);\n        range.select();\n    }\n}","// @flow\nimport React, {Component} from 'react';\nimport type {ScaleQuestion} from '../../music/question';\nimport {Key} from '../../music/key';\nimport {\n    ACCIDENTALS,\n    createNote,\n    NATURAL_ACCIDENTAL,\n    Note,\n    PITCHES\n} from '../../music/note';\nimport './ScaleQuestion.scss';\nimport {\n    AUGMENTED_DIMINISHED_INTERVALS,\n    relativeIntervalsToRootIntervals\n} from '../../music/interval';\nimport Fretboard from 'react-fretboard';\nimport Arpeggiator from '../../player/arpeggiator';\nimport NoteInput from '../NoteInput/NoteInput';\n\ntype Props = {\n    isEnabled: boolean,\n    question: ScaleQuestion,\n    onNextClick: () => void\n}\n\ntype State = {\n    notes: {[number]: Note},\n    correctNotes: {[number]: boolean},\n    isAnswered: boolean,\n    isCorrect: boolean,\n    showErrors: boolean,\n    showHint: boolean,\n    hintIndex: number,\n    highlightedNoteIndex: ?number,\n    selectedNoteIndex: number\n}\n\nconst DEFAULT_NOTE: Note = createNote(undefined, NATURAL_ACCIDENTAL);\n\nconst NBSP = '\\u00A0';\n\nexport default class ScaleQuestionComponent extends Component<Props, State> {\n    state = {\n        notes: {},\n        correctNotes: {},\n        isAnswered: false,\n        isCorrect: false,\n        showErrors: false,\n        showHint: false,\n        selectedNoteIndex: 1\n    };\n\n    get _canBeAnswered(): boolean {\n        const noteIndices = Object.keys(this.state.notes);\n        const numberOfNotes = noteIndices.length;\n        const requiredNumberOfAnswers = this.props.question.key.scale.construction.length - 1;\n        const areAllNotesComplete = noteIndices.some(noteIndex => {\n            const note = this.state.notes[noteIndex];\n            return note.pitch && PITCHES.includes(note.pitch)\n                && note.accidental && ACCIDENTALS.includes(note.accidental);\n        });\n        return numberOfNotes === requiredNumberOfAnswers && areAllNotesComplete;\n    }\n\n    componentDidMount() {\n        Arpeggiator.registerTrigger('.scaleQuestion__playButton');\n    }\n\n    _handleAnswer = (e: any) => {\n        e.preventDefault();\n        if (this._canBeAnswered) {\n            this.setState(_setAnswered());\n        }\n    };\n\n    _handleHintClick = (e: any) => {\n        e.preventDefault();\n        this.setState(_showHint());\n    };\n\n    _handlePlayClick = (e: any) => {\n        e.preventDefault();\n        Arpeggiator.play(this.props.question.key.toNotes(), this._handlePlayNote, this._handleStop);\n    };\n\n    _handlePlayNote = (noteIndex: number) => {\n        this.setState(_highlightNote(noteIndex));\n    };\n\n    _handleStop = () => {\n        this.setState(_removeNoteHighlights());\n    };\n\n    _handleNextClick = (e: any) => {\n        e.preventDefault();\n        Arpeggiator.stop(this._handleStop);\n        this.props.onNextClick();\n    };\n\n    _handleNoteChange = (noteIndex: number, note: Note) => {\n        const notes = this.props.question.key.toNotes();\n        this.setState(_updateNote(noteIndex, note, notes[noteIndex].equals(note)));\n    };\n\n    _handleSwitchNote = (nextNoteIndex: number) => {\n        const numberOfNotes = this.props.question.key.toNotes().length;\n        const minNoteIndex = 1;\n        const maxNoteIndex = numberOfNotes - 1;\n        this.setState(_selectNote(_restrictNumber(nextNoteIndex, minNoteIndex, maxNoteIndex)));\n    };\n\n    _getNote(key: Key, noteIndex: number): Note {\n        if (_isRoot(key, noteIndex)) {\n            return key.root;\n        }\n        return this.state.notes[noteIndex] ? this.state.notes[noteIndex] : DEFAULT_NOTE;\n    }\n\n    renderScaleInputs(key: Key) {\n        const numberOfNotes = key.scale.construction.length + 1;\n        return (\n            <div className=\"scaleQuestion__notes\">\n                {_range(numberOfNotes).map(noteIndex => {\n                    const note = this._getNote(key, noteIndex);\n                    const isRoot = _isRoot(key, noteIndex);\n                    const showError = !isRoot && this.state.showErrors && !this.state.correctNotes[noteIndex];\n                    const isSelected = this.state.selectedNoteIndex === noteIndex && this.props.isEnabled;\n                    return (\n                        <NoteInput\n                            key={`note-${noteIndex}`}\n                            isDisabled={isRoot}\n                            isSelected={isSelected}\n                            isHighlighted={noteIndex === this.state.highlightedNoteIndex}\n                            noteIndex={noteIndex}\n                            onChange={this._handleNoteChange}\n                            onSwitchNote={this._handleSwitchNote}\n                            note={note}\n                            showError={showError}/>\n                    );\n                })}\n            </div>\n        );\n    }\n\n    renderFretboard(showNotes: boolean = true) {\n        return (\n            <div className=\"scaleQuestion__fretboard\">\n                <Fretboard\n                    skinType=\"strings\"\n                    selectedNotes={this.props.question.key.toNotes().map((note: Note) => note.simpleNotation)}\n                    showSelectionLabels={showNotes}/>\n            </div>\n        );\n    }\n\n    renderHint(key: Key) {\n        const scaleConstruction = key.modeConstruction;\n        const hints = [\n            relativeIntervalsToRootIntervals(key.root, scaleConstruction).join(' '),\n            relativeIntervalsToRootIntervals(key.root, scaleConstruction, AUGMENTED_DIMINISHED_INTERVALS).join(' '),\n            scaleConstruction.join('-')\n        ];\n        return (\n            <div className=\"scaleQuestion__hint\">\n                <h1>Hint</h1>\n                <p>{hints[this.state.hintIndex]}</p>\n                {this.renderFretboard(false)}\n            </div>\n        );\n    }\n\n    renderSolution(key: Key) {\n        const notes = key.toNotes();\n        const modifier = this.state.isCorrect ? 'correct' : 'wrong';\n        const className = `scaleQuestion__solution scaleQuestion__solution--${modifier}`;\n        return (\n            <div className={className}>\n                <h1>{this.state.isCorrect ? 'Awesome!' : 'Wrong'}</h1>\n                <p>{this.state.isCorrect\n                    ? 'Your solution is correct!'\n                    : `Sorry, but this is correct: ${notes.map(Note.noteToString).join(' ')}`}</p>\n                {this.renderFretboard()}\n            </div>\n        );\n    }\n\n    renderActions() {\n        const answerDisabled = !this._canBeAnswered && !this.state.isAnswered;\n        const hintDisabled = this.state.isAnswered;\n        return (\n            <div className=\"scaleQuestion__actions\">\n                <button onClick={this._handleAnswer} disabled={answerDisabled}>Answer</button>\n                <button onClick={this._handleHintClick} disabled={hintDisabled}>Hint</button>\n                <button className=\"scaleQuestion__playButton\" onClick={this._handlePlayClick}>Play</button>\n                <button onClick={this._handleNextClick}>Next</button>\n            </div>\n        );\n    }\n\n    render() {\n        const key = this.props.question.key;\n        const description = key.description;\n        const modeName = description.modeName ? ` ${description.modeName}` : '';\n        const scaleName = `${description.rootNote} ${description.scaleName}${modeName}`;\n        const alternativeModeName = description.alternativeModeName ? description.alternativeModeName : NBSP;\n        return (\n            <div className=\"scaleQuestion\">\n                <div className=\"scaleQuestion__question\">\n                    <p>Complete this scale:</p>\n                    <h1 className=\"scaleQuestion__scaleName\">{scaleName}</h1>\n                    {<h2 className=\"scaleQuestion__alternativeModeName\">{alternativeModeName}</h2>}\n                </div>\n                <div className=\"scaleQuestion__answer\">\n                    {this.renderScaleInputs(key)}\n                    {this.renderActions()}\n                </div>\n                {this.state.showHint && this.renderHint(key)}\n                {this.state.isAnswered && this.renderSolution(key)}\n            </div>\n        );\n    }\n}\n\nfunction _updateNote(noteIndex: number, note: Note, isCorrect: boolean) {\n    return (state: State) => {\n        return {\n            ...state,\n            notes: {\n                ...state.notes,\n                [noteIndex]: note\n            },\n            correctNotes: {\n                ...state.correctNotes,\n                [noteIndex]: isCorrect\n            },\n            showErrors: false\n        };\n    };\n}\n\nfunction _setAnswered() {\n    return (state: State, props: Props) => {\n        const actualNotes = props.question.key.toNotes();\n        const root = actualNotes[0];\n        const notes = Object.keys(state.notes).map(noteIndex => state.notes[noteIndex]);\n        const answeredNotes = [root, ...notes, root];\n        return {\n            ...state,\n            isAnswered: true,\n            showErrors: true,\n            showHint: false,\n            isCorrect: Note.areNoteArraysEqual(actualNotes, answeredNotes)\n        };\n    };\n}\n\nfunction _showHint() {\n    return (state: State) => ({\n        ...state,\n        showHint: true,\n        isCorrect: false,\n        hintIndex: _getRandomInt(0, 2, state.hintIndex)\n    });\n}\n\nfunction _selectNote(selectedNoteIndex: number) {\n    return (state: State) => ({\n        ...state,\n        selectedNoteIndex\n    });\n}\n\nfunction _highlightNote(highlightedNoteIndex: number) {\n    return (state: State) => ({\n        ...state,\n        highlightedNoteIndex\n    });\n}\n\nfunction _removeNoteHighlights() {\n    return (state: State) => ({\n        ...state,\n        highlightedNoteIndex: undefined\n    });\n}\n\nfunction _range(length: number): number[] {\n    return Array.from(Array(length).keys());\n}\n\nfunction _getRandomInt(min: number, max: number, exclude: number = min - 1): number {\n    const randomInt = Math.floor(Math.random() * (max - min + 1)) + min;\n    if (randomInt === exclude) {\n        return _getRandomInt(min, max, exclude);\n    }\n    return randomInt;\n}\n\nfunction _isRoot(key: Key, noteIndex: number): boolean {\n    return noteIndex === 0 || noteIndex === key.scale.construction.length;\n}\n\nfunction _restrictNumber(value: number, min: number, max: number) {\n    return ((value - min) % (max - min) + max - min) % (max - min) + min;\n}","import type {Question} from './question';\nimport {\n    ACCIDENTALS,\n    createNote,\n    FLAT_ACCIDENTAL,\n    NATURAL_ACCIDENTAL,\n    Note,\n    PITCHES,\n    SHARP_ACCIDENTAL\n} from './note';\nimport type {Mode} from './mode';\nimport {Key} from './key';\nimport type {ScaleName} from './scale';\nimport {\n    getScaleByName,\n    Scale\n} from './scale';\n\nexport type ScaleOptions = {\n    [ScaleName]: boolean\n};\n\nexport const IGNORED_NOTES: Note = [\n    createNote('B', SHARP_ACCIDENTAL),\n    createNote('C', FLAT_ACCIDENTAL),\n    createNote('E', SHARP_ACCIDENTAL),\n    createNote('F', FLAT_ACCIDENTAL)\n];\n\nexport function getRandomKey(includeAccidentals: boolean, includeModes: boolean, scaleOptions: ScaleOptions): Key {\n    const scale = getRandomScale(scaleOptions);\n    const mode = scale.modes.length > 0\n        ? includeModes ? getRandomMode(scale) : scale.modes[0]\n        : undefined;\n    return new Key(\n        getRandomNote(includeAccidentals),\n        scale,\n        mode\n    );\n}\n\nexport function getRandomScale(scaleOptions: ScaleOptions): Scale {\n    const scales = _scaleOptionsToScaleNames(scaleOptions).map(getScaleByName);\n    return getRandomArrayElement(scales);\n}\n\nexport function getRandomMode(scale: Scale): Mode {\n    return getRandomArrayElement(scale.modes);\n}\n\nexport function getRandomQuestion(includeAccidentals: boolean,\n    includeModes: boolean,\n    scaleOptions: ScaleOptions): Question {\n    const key = getRandomKey(\n        includeAccidentals,\n        includeModes,\n        scaleOptions\n    );\n    return {\n        type: 'scale',\n        key\n    };\n}\n\nexport function getRandomArrayElement<T>(array: T[]): T {\n    return array[Math.floor(Math.random() * array.length)];\n}\n\nexport function isIgnoredNote(note: Note): boolean {\n    return !IGNORED_NOTES.map((ignoredNote: Note) => ignoredNote.equals(note)).some(comparison => !comparison);\n}\n\nexport function getRandomNote(includeAccidentals: boolean): Note {\n    const note = createNote(\n        getRandomArrayElement(PITCHES),\n        includeAccidentals ? getRandomArrayElement(ACCIDENTALS) : NATURAL_ACCIDENTAL\n    );\n    if (isIgnoredNote(note)) {\n        return getRandomNote();\n    }\n    return note;\n}\n\nfunction _scaleOptionsToScaleNames(scaleOptions: ScaleOptions): ScaleName[] {\n    return Object.keys(scaleOptions).reduce((scaleNames: ScaleName[], scaleName: ScaleName) => {\n        if (scaleOptions[scaleName]) {\n            return [\n                ...scaleNames,\n                scaleName\n            ];\n        }\n        return scaleNames;\n    }, []);\n}","// @flow\nimport React, {Component} from 'react';\nimport type {ScaleName} from '../../music/scale';\nimport {\n    MAJOR_SCALE,\n    Scale,\n    SCALES\n} from '../../music/scale';\nimport type {ScaleOptions} from '../../music/random';\nimport './Menu.scss';\n\nexport type Options = {\n    includeAccidentals: boolean,\n    includeModes: boolean,\n    scales: ScaleOptions\n};\n\nexport type OptionChangeHandler = (option: string, isEnabled: boolean) => void;\nexport type ScaleOptionChangeHandler = (scale: ScaleName, isEnabled: boolean) => void;\n\ntype Props = {\n    isOpen: boolean,\n    onClose: () => void,\n    onOptionChange: OptionChangeHandler,\n    onScaleOptionChange: ScaleOptionChangeHandler,\n    options: Options\n};\n\nexport default class Menu extends Component<Props> {\n    get _onlyMajorScaleSelected(): string {\n        const scales = this.props.options.scales;\n        const numberOfScales = Object.keys(scales)\n            .reduce((numberOfScales: number, scale: ScaleName) => scales[scale] ? numberOfScales + 1 : numberOfScales,\n                0);\n        return numberOfScales === 1 && scales[MAJOR_SCALE.name];\n    }\n\n    _handleOptionChange = (event: any) => {\n        this.props.onOptionChange(event.target.value, event.target.checked);\n    };\n\n    _handleScaleOptionChange = (event: any) => {\n        this.props.onScaleOptionChange(event.target.value, event.target.checked);\n    };\n\n    renderOptions() {\n        const onlyMajorScaleSelected = this._onlyMajorScaleSelected;\n        return (\n            <div className=\"menu__options\">\n                <details className=\"menu__accidentals\">\n                    <summary>Notes</summary>\n                    <div className=\"menu__menuItemGroup\">\n                        <label htmlFor=\"includeAccidentals\" className=\"menu__menuItem\">\n                            <input\n                                type=\"checkbox\"\n                                id=\"includeAccidentals\"\n                                name=\"includeAccidentals\"\n                                value=\"includeAccidentals\"\n                                checked={this.props.options.includeAccidentals}\n                                onChange={this._handleOptionChange}/>\n                            Accidentals\n                        </label>\n                    </div>\n                </details>\n                <details className=\"menu__scales\">\n                    <summary>Scales</summary>\n                    <div className=\"menu__menuItemGroup\">\n                        {SCALES.map((scale: Scale) => (\n                            <label htmlFor={scale.name} key={scale.name} className=\"menu__menuItem\">\n                                <input\n                                    type=\"checkbox\"\n                                    id={scale.name}\n                                    name={scale.name}\n                                    value={scale.name}\n                                    checked={this.props.options.scales[scale.name]}\n                                    disabled={onlyMajorScaleSelected && scale.name === MAJOR_SCALE.name}\n                                    onChange={this._handleScaleOptionChange}/>\n                                {scale.name}\n                            </label>\n                        ))}\n                    </div>\n                </details>\n                <details className=\"menu__modes\">\n                    <summary>Modes</summary>\n                    <div className=\"menu__menuItemGroup\">\n                        <label htmlFor=\"includeModes\" className=\"menu__menuItem\">\n                            <input\n                                type=\"checkbox\"\n                                id=\"includeModes\"\n                                name=\"includeModes\"\n                                value=\"includeModes\"\n                                checked={this.props.options.includeModes}\n                                onChange={this._handleOptionChange}/>\n                            Modes\n                        </label>\n                    </div>\n                </details>\n            </div>\n        );\n    }\n\n    render() {\n        const className = `menu${this.props.isOpen ? ' menu--open' : ''}`;\n        return (\n            <div className={className}>\n                <button className=\"menu__closeMenuButton\" onClick={this.props.onClose}/>\n                {this.renderOptions()}\n            </div>\n        );\n\n    }\n}","// @flow\nimport React from 'react';\nimport './MenuBar.scss';\n\ntype Props = {\n    onOpen: () => void\n}\n\nexport default function MenuBar({onOpen}: Props) {\n    return (\n        <div className=\"menuBar\">\n            <button className=\"menuBar__openMenuButton\" onClick={onOpen}/>\n        </div>\n    );\n}","// @flow\nimport React, {Component} from 'react';\nimport ScaleQuestion from '../ScaleQuestion/ScaleQuestion';\nimport type {ScaleOptions} from '../../music/random';\nimport {getRandomQuestion} from '../../music/random';\nimport type {Question} from '../../music/question';\nimport type {ScaleName} from '../../music/scale';\nimport {\n    MAJOR_SCALE,\n    Scale,\n    SCALES\n} from '../../music/scale';\nimport type {Options} from '../Menu/Menu';\nimport Menu from '../Menu/Menu';\nimport MenuBar from '../Menu/MenuBar';\nimport './ScaleTrainer.scss';\n\ntype State = {\n    isMenuOpen: boolean,\n    question: ?Question,\n    options: Options\n};\n\nconst DEFAULT_SCALES = SCALES.reduce((scales: ScaleOptions, scale: Scale) => ({...scales, [scale.name]: true}), {});\n\nconst INITIAL_STATE = {\n    isMenuOpen: false,\n    question: undefined,\n    options: {\n        includeAccidentals: _getBooleanFromLocalStorage('includeAccidentals'),\n        includeModes: _getBooleanFromLocalStorage('includeModes'),\n        scales: _getObjectFromLocalStorage('scales', DEFAULT_SCALES)\n    }\n};\n\nexport default class ScaleTrainer extends Component<void, State> {\n    state = INITIAL_STATE;\n\n    componentWillMount() {\n        this._updateQuestion();\n    }\n\n    _handleNextClick = () => {\n        this._updateQuestion();\n    };\n\n    _handleOptionChange = (option: string, isEnabled: boolean) => {\n        this.setState(_updateOption(option, isEnabled), this._updateQuestion);\n    };\n\n    _handleScaleOptionChange = (scale: ScaleName, isEnabled: boolean) => {\n        this.setState(_updateScaleOption(scale, isEnabled), this._updateQuestion);\n    };\n\n    _handleMenuButtonClick = () => {\n        this.setState(_toggleMenu());\n    };\n\n    _updateQuestion = () => {\n        this.setState(_setRandomQuestion());\n    };\n\n    renderQuestion() {\n        const question = this.state.question;\n        if (question && question.type === 'scale') {\n            return (\n                <ScaleQuestion\n                    key={_questionToString(question)}\n                    isEnabled={!this.state.isMenuOpen}\n                    question={question}\n                    onNextClick={this._handleNextClick}/>\n            );\n        }\n        return (\n            <div>Loading...</div>\n        );\n    }\n\n    render() {\n        return (\n            <div className=\"scaleTrainer\">\n                <Menu\n                    isOpen={this.state.isMenuOpen}\n                    onClose={this._handleMenuButtonClick}\n                    onOptionChange={this._handleOptionChange}\n                    onScaleOptionChange={this._handleScaleOptionChange}\n                    options={this.state.options}/>\n                <MenuBar onOpen={this._handleMenuButtonClick}/>\n                {this.renderQuestion()}\n            </div>\n        );\n    }\n}\n\nfunction _updateOption(option: string, value: boolean) {\n    return (state: State) => {\n        localStorage.setItem(option, value);\n        return {\n            ...state,\n            options: {\n                ...state.options,\n                [option]: value\n            }\n        };\n    };\n}\n\nfunction _updateScaleOption(scale: string, value: boolean) {\n    return (state: State) => {\n        const scales = _selectRequiredScales({\n            ...state.options.scales,\n            [scale]: value\n        });\n        localStorage.setItem('scales', JSON.stringify(scales));\n        return {\n            ...state,\n            options: {\n                ...state.options,\n                scales\n            }\n        };\n    };\n}\n\nfunction _selectRequiredScales(scales: ScaleOptions) {\n    const zeroScalesSelected = !Object.keys(scales).some(s => scales[s]);\n    return zeroScalesSelected ? {\n        ...scales,\n        [MAJOR_SCALE.name]: true\n    } : scales;\n}\n\nfunction _toggleMenu() {\n    return (state: State) => ({\n        isMenuOpen: !state.isMenuOpen\n    });\n}\n\nfunction _setRandomQuestion() {\n    return (state: State) => ({\n        question: getRandomQuestion(\n            state.options.includeAccidentals,\n            state.options.includeModes,\n            state.options.scales\n        )\n    });\n}\n\nfunction _questionToString(question: Question): string {\n    return `${question.type}${question.key}`;\n}\n\nfunction _getBooleanFromLocalStorage(key: string, defaultValue = true): boolean {\n    const value = localStorage.getItem(key);\n    if (value === null || typeof value === 'undefined') {\n        return defaultValue;\n    }\n    return value === 'true';\n}\n\nfunction _getObjectFromLocalStorage(key: string, defaultValue = {}): boolean {\n    const value = localStorage.getItem(key);\n    if (value === null || typeof value === 'undefined') {\n        return defaultValue;\n    }\n    return {\n        ...defaultValue,\n        ...JSON.parse(value)\n    };\n}","// @flow\nimport React from 'react';\nimport './Breakpoint.scss';\n\nexport default function Breakpoint() {\n    return (\n        <>\n            <div className=\"breakpoint breakpoint--mobile\">Mobile</div>\n            <div className=\"breakpoint breakpoint--tablet\">Tablet</div>\n            <div className=\"breakpoint breakpoint--desktop\">Desktop</div>\n        </>\n    );\n}","import React, {Component} from 'react';\nimport ScaleTrainer from '../ScaleTrainer/ScaleTrainer';\nimport Breakpoint from '../Breakpoint/Breakpoint';\n\nclass App extends Component {\n    render() {\n        return (\n            <>\n                <ScaleTrainer/>\n                <Breakpoint/>\n            </>\n        );\n    }\n}\n\nexport default App;\n","// In production, we register a service worker to serve assets from local cache.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\n// cached resources are updated in the background.\n\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\n// This link also includes instructions on opting out of this behavior.\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://goo.gl/SC7cgQ'\n          );\n        });\n      } else {\n        // Is not local host. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the old content will have been purged and\n              // the fresh content will have been added to the cache.\n              // It's the perfect time to display a \"New content is\n              // available; please refresh.\" message in your web app.\n              console.log('New content is available; please refresh.');\n\n              // Execute callback\n              if (config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      if (\n        response.status === 404 ||\n        response.headers.get('content-type').indexOf('javascript') === -1\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './components/App/App';\nimport * as serviceWorker from './serviceWorker';\nimport './index.scss';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}